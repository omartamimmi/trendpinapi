{
    "sourceFile": "Modules/StagedForm/app/Providers/StagedFormServiceProvider.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1758609825688,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758609832788,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n <?php\n \n-namespace Modules\\StagedForm\\Providers;\n+namespace Modules\\StagedForm\\app\\Providers;\n \n use Illuminate\\Support\\Facades\\Blade;\n use Illuminate\\Support\\ServiceProvider;\n use Nwidart\\Modules\\Traits\\PathNamespace;\n"
                },
                {
                    "date": 1758625685216,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,154 @@\n+<?php\n+\n+namespace Modules\\StagedForm\\app\\Providers;\n+\n+use Illuminate\\Support\\Facades\\Blade;\n+use Illuminate\\Support\\ServiceProvider;\n+use Nwidart\\Modules\\Traits\\PathNamespace;\n+use RecursiveDirectoryIterator;\n+use RecursiveIteratorIterator;\n+\n+class StagedFormServiceProvider extends ServiceProvider\n+{\n+    use PathNamespace;\n+\n+    protected string $name = 'StagedForm';\n+\n+    protected string $nameLower = 'stagedform';\n+\n+    /**\n+     * Boot the application events.\n+     */\n+    public function boot(): void\n+    {\n+        $this->registerCommands();\n+        $this->registerCommandSchedules();\n+        $this->registerTranslations();\n+        $this->registerConfig();\n+        $this->registerViews();\n+        $this->loadMigrationsFrom(module_path($this->name, 'database/migrations'));\n+    }\n+\n+    /**\n+     * Register the service provider.\n+     */\n+    public function register(): void\n+    {\n+        $this->app->register(EventServiceProvider::class);\n+        $this->app->register(RouteServiceProvider::class);\n+    }\n+\n+    /**\n+     * Register commands in the format of Command::class\n+     */\n+    protected function registerCommands(): void\n+    {\n+        // $this->commands([]);\n+    }\n+\n+    /**\n+     * Register command Schedules.\n+     */\n+    protected function registerCommandSchedules(): void\n+    {\n+        // $this->app->booted(function () {\n+        //     $schedule = $this->app->make(Schedule::class);\n+        //     $schedule->command('inspire')->hourly();\n+        // });\n+    }\n+\n+    /**\n+     * Register translations.\n+     */\n+    public function registerTranslations(): void\n+    {\n+        $langPath = resource_path('lang/modules/'.$this->nameLower);\n+\n+        if (is_dir($langPath)) {\n+            $this->loadTranslationsFrom($langPath, $this->nameLower);\n+            $this->loadJsonTranslationsFrom($langPath);\n+        } else {\n+            $this->loadTranslationsFrom(module_path($this->name, 'lang'), $this->nameLower);\n+            $this->loadJsonTranslationsFrom(module_path($this->name, 'lang'));\n+        }\n+    }\n+\n+    /**\n+     * Register config.\n+     */\n+    protected function registerConfig(): void\n+    {\n+        $configPath = module_path($this->name, config('modules.paths.generator.config.path'));\n+dd($configPath);\n+        if (is_dir($configPath)) {\n+            $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($configPath));\n+\n+            foreach ($iterator as $file) {\n+                if ($file->isFile() && $file->getExtension() === 'php') {\n+                    $config = str_replace($configPath.DIRECTORY_SEPARATOR, '', $file->getPathname());\n+                    $config_key = str_replace([DIRECTORY_SEPARATOR, '.php'], ['.', ''], $config);\n+                    $segments = explode('.', $this->nameLower.'.'.$config_key);\n+\n+                    // Remove duplicated adjacent segments\n+                    $normalized = [];\n+                    foreach ($segments as $segment) {\n+                        if (end($normalized) !== $segment) {\n+                            $normalized[] = $segment;\n+                        }\n+                    }\n+\n+                    $key = ($config === 'config.php') ? $this->nameLower : implode('.', $normalized);\n+\n+                    $this->publishes([$file->getPathname() => config_path($config)], 'config');\n+                    $this->merge_config_from($file->getPathname(), $key);\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Merge config from the given path recursively.\n+     */\n+    protected function merge_config_from(string $path, string $key): void\n+    {\n+        $existing = config($key, []);\n+        $module_config = require $path;\n+\n+        config([$key => array_replace_recursive($existing, $module_config)]);\n+    }\n+\n+    /**\n+     * Register views.\n+     */\n+    public function registerViews(): void\n+    {\n+        $viewPath = resource_path('views/modules/'.$this->nameLower);\n+        $sourcePath = module_path($this->name, 'resources/views');\n+\n+        $this->publishes([$sourcePath => $viewPath], ['views', $this->nameLower.'-module-views']);\n+\n+        $this->loadViewsFrom(array_merge($this->getPublishableViewPaths(), [$sourcePath]), $this->nameLower);\n+\n+        Blade::componentNamespace(config('modules.namespace').'\\\\' . $this->name . '\\\\View\\\\Components', $this->nameLower);\n+    }\n+\n+    /**\n+     * Get the services provided by the provider.\n+     */\n+    public function provides(): array\n+    {\n+        return [];\n+    }\n+\n+    private function getPublishableViewPaths(): array\n+    {\n+        $paths = [];\n+        foreach (config('view.paths') as $path) {\n+            if (is_dir($path.'/modules/'.$this->nameLower)) {\n+                $paths[] = $path.'/modules/'.$this->nameLower;\n+            }\n+        }\n+\n+        return $paths;\n+    }\n+}\n"
                }
            ],
            "date": 1758609825688,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace Modules\\StagedForm\\app\\Providers;\n\nuse Illuminate\\Support\\Facades\\Blade;\nuse Illuminate\\Support\\ServiceProvider;\nuse Nwidart\\Modules\\Traits\\PathNamespace;\nuse RecursiveDirectoryIterator;\nuse RecursiveIteratorIterator;\n\nclass StagedFormServiceProvider extends ServiceProvider\n{\n    use PathNamespace;\n\n    protected string $name = 'StagedForm';\n\n    protected string $nameLower = 'stagedform';\n\n    /**\n     * Boot the application events.\n     */\n    public function boot(): void\n    {\n        $this->registerCommands();\n        $this->registerCommandSchedules();\n        $this->registerTranslations();\n        $this->registerConfig();\n        $this->registerViews();\n        $this->loadMigrationsFrom(module_path($this->name, 'database/migrations'));\n    }\n\n    /**\n     * Register the service provider.\n     */\n    public function register(): void\n    {\n        $this->app->register(EventServiceProvider::class);\n        $this->app->register(RouteServiceProvider::class);\n    }\n\n    /**\n     * Register commands in the format of Command::class\n     */\n    protected function registerCommands(): void\n    {\n        // $this->commands([]);\n    }\n\n    /**\n     * Register command Schedules.\n     */\n    protected function registerCommandSchedules(): void\n    {\n        // $this->app->booted(function () {\n        //     $schedule = $this->app->make(Schedule::class);\n        //     $schedule->command('inspire')->hourly();\n        // });\n    }\n\n    /**\n     * Register translations.\n     */\n    public function registerTranslations(): void\n    {\n        $langPath = resource_path('lang/modules/'.$this->nameLower);\n\n        if (is_dir($langPath)) {\n            $this->loadTranslationsFrom($langPath, $this->nameLower);\n            $this->loadJsonTranslationsFrom($langPath);\n        } else {\n            $this->loadTranslationsFrom(module_path($this->name, 'lang'), $this->nameLower);\n            $this->loadJsonTranslationsFrom(module_path($this->name, 'lang'));\n        }\n    }\n\n    /**\n     * Register config.\n     */\n    protected function registerConfig(): void\n    {\n        $configPath = module_path($this->name, config('modules.paths.generator.config.path'));\n\n        if (is_dir($configPath)) {\n            $iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($configPath));\n\n            foreach ($iterator as $file) {\n                if ($file->isFile() && $file->getExtension() === 'php') {\n                    $config = str_replace($configPath.DIRECTORY_SEPARATOR, '', $file->getPathname());\n                    $config_key = str_replace([DIRECTORY_SEPARATOR, '.php'], ['.', ''], $config);\n                    $segments = explode('.', $this->nameLower.'.'.$config_key);\n\n                    // Remove duplicated adjacent segments\n                    $normalized = [];\n                    foreach ($segments as $segment) {\n                        if (end($normalized) !== $segment) {\n                            $normalized[] = $segment;\n                        }\n                    }\n\n                    $key = ($config === 'config.php') ? $this->nameLower : implode('.', $normalized);\n\n                    $this->publishes([$file->getPathname() => config_path($config)], 'config');\n                    $this->merge_config_from($file->getPathname(), $key);\n                }\n            }\n        }\n    }\n\n    /**\n     * Merge config from the given path recursively.\n     */\n    protected function merge_config_from(string $path, string $key): void\n    {\n        $existing = config($key, []);\n        $module_config = require $path;\n\n        config([$key => array_replace_recursive($existing, $module_config)]);\n    }\n\n    /**\n     * Register views.\n     */\n    public function registerViews(): void\n    {\n        $viewPath = resource_path('views/modules/'.$this->nameLower);\n        $sourcePath = module_path($this->name, 'resources/views');\n\n        $this->publishes([$sourcePath => $viewPath], ['views', $this->nameLower.'-module-views']);\n\n        $this->loadViewsFrom(array_merge($this->getPublishableViewPaths(), [$sourcePath]), $this->nameLower);\n\n        Blade::componentNamespace(config('modules.namespace').'\\\\' . $this->name . '\\\\View\\\\Components', $this->nameLower);\n    }\n\n    /**\n     * Get the services provided by the provider.\n     */\n    public function provides(): array\n    {\n        return [];\n    }\n\n    private function getPublishableViewPaths(): array\n    {\n        $paths = [];\n        foreach (config('view.paths') as $path) {\n            if (is_dir($path.'/modules/'.$this->nameLower)) {\n                $paths[] = $path.'/modules/'.$this->nameLower;\n            }\n        }\n\n        return $paths;\n    }\n}\n"
        }
    ]
}