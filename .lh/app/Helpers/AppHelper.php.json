{
    "sourceFile": "app/Helpers/AppHelper.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1758780198213,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1758780268366,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,10 +105,6 @@\n         \"continentCode\" => $continentCode ?? '',\n     ];\n }\n \n-public function isLastStep(string $stageType, int $currentStep): bool\n-{\n-    $steps = config(\"stagedform.$stageType\", []);\n-    return $currentStep === count($steps);\n-}\n \n+\n"
                }
            ],
            "date": 1758780198213,
            "name": "Commit-0",
            "content": "<?php\n\nuse MaxMind\\Db\\Reader;\n\n\n//include '../../custom/Helpers/CustomHelper.php';\n\ndefine('MINUTE_IN_SECONDS', 60);\ndefine('HOUR_IN_SECONDS', 60 * MINUTE_IN_SECONDS);\ndefine('DAY_IN_SECONDS', 24 * HOUR_IN_SECONDS);\ndefine('WEEK_IN_SECONDS', 7 * DAY_IN_SECONDS);\ndefine('MONTH_IN_SECONDS', 30 * DAY_IN_SECONDS);\ndefine('YEAR_IN_SECONDS', 365 * DAY_IN_SECONDS);\n\nfunction get_client_ip()\n{\n    $ipaddress = '';\n    if (isset($_SERVER['HTTP_CLIENT_IP'])) {\n        $ipaddress = $_SERVER['HTTP_CLIENT_IP'];\n    } else if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {\n        $ipaddress = $_SERVER['HTTP_X_FORWARDED_FOR'];\n    } else if (isset($_SERVER['HTTP_X_FORWARDED'])) {\n        $ipaddress = $_SERVER['HTTP_X_FORWARDED'];\n    } else if (isset($_SERVER['HTTP_FORWARDED_FOR'])) {\n        $ipaddress = $_SERVER['HTTP_FORWARDED_FOR'];\n    } else if (isset($_SERVER['HTTP_FORWARDED'])) {\n        $ipaddress = $_SERVER['HTTP_FORWARDED'];\n    } else if (isset($_SERVER['REMOTE_ADDR'])) {\n        $ipaddress = $_SERVER['REMOTE_ADDR'];\n    } else {\n        $ipaddress = 'UNKNOWN';\n    }\n\n    $ipAddressArr = ['127.0.0.1', '172.20.0.1', '172.20.0.4', '10.0.0.4', '::1'];\n\n    if (in_array($ipaddress, $ipAddressArr)) {\n        $ipaddress = '212.34.11.204';\n    }\n\n\n    $ipArr = explode(',', $ipaddress);\n\n    if (count($ipArr) > 1) {\n        return $ipArr[1];\n    }\n    return $ipArr[0];\n}\n\n\n/**\n * This function extract the location of the user using the IP address.\n */\nfunction getLocation()\n{\n\n    $ip = get_client_ip();\n    $db = resource_path() . '/geolite2/GeoLite2-City.mmdb';\n    $reader = new Reader($db);\n    $country = null;\n    $city = null;\n    $countryCode = null;\n    $ip_lat = null;\n    $ip_lng = null;\n\n    $continentCode = null;\n    $continent = null;\n\n    if (filter_var($ip, FILTER_VALIDATE_IP)) {\n\n        if (!empty($reader->get($ip)['country'])) {\n            $country = $reader->get($ip)['country']['names']['en'];\n            !empty(['country']);\n        };\n\n        if (!empty($reader->get($ip)['city'])) {\n            $city = $reader->get($ip)['city']['names']['en'];\n            !empty(['city']);\n        };\n\n        if (!empty($reader->get($ip)['country'])) {\n            $countryCode = $reader->get($ip)['country']['iso_code'];\n            !empty(['countryCode']);\n        }\n\n        if (!empty($reader->get($ip)['location'])) {\n            $ip_lat = $reader->get($ip)['location']['latitude'];\n            !empty(['ip_lat']);\n            $ip_lng = $reader->get($ip)['location']['longitude'];\n            !empty(['ip_lng']);\n        };\n\n        $res = $reader->get($ip);\n        $continent = $res['continent']['names']['en'] ?? '';\n        $continentCode = $res['continent']['code'] ?? '';\n    }\n\n    return [\n        'ip' => $ip ?? '',\n        \"country\" => $country ?? '',\n        \"city\" => $city ?? '',\n        \"countryCode\" => $countryCode ?? '',\n        \"ip_lat\" => $ip_lat ?? 0,\n        \"ip_lng\" => $ip_lng ?? 0,\n        \"continent\" => $continent ?? '',\n        \"continentCode\" => $continentCode ?? '',\n    ];\n}\n\npublic function isLastStep(string $stageType, int $currentStep): bool\n{\n    $steps = config(\"stagedform.$stageType\", []);\n    return $currentStep === count($steps);\n}\n\n"
        }
    ]
}